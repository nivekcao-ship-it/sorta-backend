"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseClass = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_cdk_lib_1 = require("aws-cdk-lib");
const appsync = require("aws-cdk-lib/aws-appsync");
const lambda = require("aws-cdk-lib/aws-lambda");
const logs = require("aws-cdk-lib/aws-logs");
const constructs_1 = require("constructs");
const construct_name_enum_1 = require("./construct-name-enum");
const utils_1 = require("../helpers/utils");
class BaseClass extends constructs_1.Construct {
    constructor(scope, id) {
        super(scope, id);
        /**
         * construct usage metric , added in template description
         */
        this.constructUsageMetric = 'uksb-1tupboc45';
        /**
         * enable disable lambda tracing
         *
         * @default - Active
         */
        this.lambdaTracing = lambda.Tracing.ACTIVE;
        /**
         * enable disable xray tracing
         *
         * @default - True
         */
        this.enablexray = true;
        /**
         * Default  log config for all constructs
         */
        this.fieldLogLevel = appsync.FieldLogLevel.ALL;
        /**
         * Default  log retention config for all constructs
         */
        this.retention = logs.RetentionDays.TEN_YEARS;
    }
    //overwrite default env suffix
    updateEnvSuffix(props) {
        let stage = '-dev';
        if (props?.stage) {
            stage = props.stage;
        }
        this.stage = stage;
    }
    /*
    * update template description with construct usage metric and
    * add AWS_SDK_UA_APP_ID to user agent on aws sdk.
    */
    updateConstructUsageMetricCode(props, scope, lambdaFunctions) {
        const solutionId = `genai_cdk_${utils_1.version}/${props.constructName}/${props.constructId}`;
        if (lambdaFunctions
            && lambdaFunctions.length > 0) {
            for (let lambdaFunction of lambdaFunctions) {
                lambdaFunction.addEnvironment('AWS_SDK_UA_APP_ID', solutionId);
            }
        }
        if (props && BaseClass.usageMetricMap.hasOwnProperty(props.constructName)) {
            BaseClass.usageMetricMap[props.constructName] = BaseClass.usageMetricMap[props.constructName] + 1;
        }
        else {
            throw Error('construct name is not present in usageMetricMap ');
        }
        const usageMetricMapSerialized = JSON.stringify(BaseClass.usageMetricMap).replace(/[{}]/g, '').replace(/"/g, '');
        // Description format :(usage id :uksb-1tupboc45)(version:0.0.0) (constructs :::{\"C1\":1,\"C2\":5,\"C3\":3,\"C4\":0,\"C5\":0,\"C6\":0,\"C7\":0,\"C8\":0}) ",
        // where C1,C2, etc are mapped with construct-name-enum and the values shows the number of time stack created/deleted.
        aws_cdk_lib_1.Stack.of(scope).templateOptions.description =
            `Description: (${this.constructUsageMetric}) (version:${utils_1.version}) (tag:${usageMetricMapSerialized}) `;
    }
    // observability
    addObservabilityToConstruct(props) {
        if (props.observability == false) {
            this.enablexray = false;
            this.lambdaTracing = lambda.Tracing.DISABLED;
            this.fieldLogLevel = appsync.FieldLogLevel.NONE;
            this.retention = logs.RetentionDays.TEN_YEARS;
        }
        ;
    }
}
exports.BaseClass = BaseClass;
_a = JSII_RTTI_SYMBOL_1;
BaseClass[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.BaseClass", version: "0.1.309" };
/**
 * Record<string, number> , maps construct name with number of deployments
 */
BaseClass.usageMetricMap = {
    [construct_name_enum_1.ConstructName.AWSMODELDEPLOYMENTSAGEMAKER]: 0,
    [construct_name_enum_1.ConstructName.CUSTOMSAGEMAKERENDPOINT]: 0,
    [construct_name_enum_1.ConstructName.HUGGINGFACESAGEMAKERENDPOINT]: 0,
    [construct_name_enum_1.ConstructName.JUMPSTARTSAGEMAKERENDPOINT]: 0,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1jbGFzcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21tb24vYmFzZS1jbGFzcy9iYXNlLWNsYXNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7Ozs7O0dBV0c7QUFFSCw2Q0FBb0M7QUFDcEMsbURBQW1EO0FBQ25ELGlEQUFpRDtBQUNqRCw2Q0FBNkM7QUFDN0MsMkNBQXVDO0FBQ3ZDLCtEQUFzRDtBQUN0RCw0Q0FBMkM7QUFnQzNDLE1BQWEsU0FBVSxTQUFRLHNCQUFTO0lBa0R0QyxZQUFZLEtBQWdCLEVBQUUsRUFBVTtRQUN0QyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBdENuQjs7V0FFRztRQUNNLHlCQUFvQixHQUFHLGdCQUFnQixDQUFDO1FBU2pEOzs7O1dBSUc7UUFDSCxrQkFBYSxHQUFtQixNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUV0RDs7OztXQUlHO1FBQ0gsZUFBVSxHQUFZLElBQUksQ0FBQztRQUUzQjs7V0FFRztRQUNILGtCQUFhLEdBQXlCLE9BQU8sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDO1FBRWhFOztXQUVHO1FBQ0gsY0FBUyxHQUF1QixJQUFJLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQztJQU03RCxDQUFDO0lBRUQsOEJBQThCO0lBQ3BCLGVBQWUsQ0FBQyxLQUFxQjtRQUM3QyxJQUFJLEtBQUssR0FBRyxNQUFNLENBQUM7UUFDbkIsSUFBSSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUM7WUFDakIsS0FBSyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7UUFDdEIsQ0FBQztRQUNELElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ3JCLENBQUM7SUFFRDs7O01BR0U7SUFDUSw4QkFBOEIsQ0FBQyxLQUFxQixFQUFFLEtBQWdCLEVBQUUsZUFBNkM7UUFFN0gsTUFBTSxVQUFVLEdBQUcsYUFBYSxlQUFPLElBQUksS0FBSyxDQUFDLGFBQWEsSUFBSSxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFdEYsSUFBSSxlQUFlO2VBQ1osZUFBZSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNsQyxLQUFLLElBQUksY0FBYyxJQUFJLGVBQWUsRUFBRSxDQUFDO2dCQUMzQyxjQUFjLENBQUMsY0FBYyxDQUMzQixtQkFBbUIsRUFBRSxVQUFVLENBQ2hDLENBQUM7WUFDSixDQUFDO1FBQ0gsQ0FBQztRQUVELElBQUksS0FBSyxJQUFJLFNBQVMsQ0FBQyxjQUFjLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDO1lBQzFFLFNBQVMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwRyxDQUFDO2FBQU0sQ0FBQztZQUNOLE1BQU0sS0FBSyxDQUFDLGtEQUFrRCxDQUFDLENBQUM7UUFDbEUsQ0FBQztRQUVELE1BQU0sd0JBQXdCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpILDZKQUE2SjtRQUM3SixzSEFBc0g7UUFDdEgsbUJBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsZUFBZSxDQUFDLFdBQVc7WUFDM0MsaUJBQWlCLElBQUksQ0FBQyxvQkFBb0IsY0FBYyxlQUFPLFVBQVcsd0JBQXdCLElBQUksQ0FBQztJQUV6RyxDQUFDO0lBRUQsZ0JBQWdCO0lBQ04sMkJBQTJCLENBQUMsS0FBcUI7UUFDekQsSUFBSSxLQUFLLENBQUMsYUFBYSxJQUFJLEtBQUssRUFBRSxDQUFDO1lBQ2pDLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO1lBQ3hCLElBQUksQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUM7WUFDN0MsSUFBSSxDQUFDLGFBQWEsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQztZQUNoRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDO1FBQ2hELENBQUM7UUFBQSxDQUFDO0lBQ0osQ0FBQzs7QUF4R0gsOEJBeUdDOzs7QUF2R0M7O0dBRUc7QUFDYyx3QkFBYyxHQUE0QjtJQUN6RCxDQUFDLG1DQUFhLENBQUMsMkJBQTJCLENBQUMsRUFBRSxDQUFDO0lBQzlDLENBQUMsbUNBQWEsQ0FBQyx1QkFBdUIsQ0FBQyxFQUFFLENBQUM7SUFDMUMsQ0FBQyxtQ0FBYSxDQUFDLDRCQUE0QixDQUFDLEVBQUUsQ0FBQztJQUMvQyxDQUFDLG1DQUFhLENBQUMsMEJBQTBCLENBQUMsRUFBRSxDQUFDO0NBQzlDLEFBTDhCLENBSzdCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiAgQ29weXJpZ2h0IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqICB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogIG9yIGluIHRoZSAnbGljZW5zZScgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gJ0FTIElTJyBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTXG4gKiAgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqICBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgU3RhY2sgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgKiBhcyBhcHBzeW5jIGZyb20gJ2F3cy1jZGstbGliL2F3cy1hcHBzeW5jJztcbmltcG9ydCAqIGFzIGxhbWJkYSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtbGFtYmRhJztcbmltcG9ydCAqIGFzIGxvZ3MgZnJvbSAnYXdzLWNkay1saWIvYXdzLWxvZ3MnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3ROYW1lIH0gZnJvbSAnLi9jb25zdHJ1Y3QtbmFtZS1lbnVtJztcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tICcuLi9oZWxwZXJzL3V0aWxzJztcblxuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2VDbGFzc1Byb3BzIHtcbiAgLyoqXG4gICAqIFZhbHVlIHdpbGwgYmUgYXBwZW5kZWQgdG8gcmVzb3VyY2VzIG5hbWUuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gX2RldlxuICAgKi9cbiAgcmVhZG9ubHkgc3RhZ2U/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIG5hbWUgb2YgdGhlIGNvbnN0cnVjdC5cbiAgICpcbiAgICovXG4gIHJlYWRvbmx5IGNvbnN0cnVjdE5hbWU6IENvbnN0cnVjdE5hbWU7XG5cbiAgLyoqXG4gICAqIGNvbnN0cnVjdCBpZC5cbiAgICpcbiAgICovXG4gIHJlYWRvbmx5IGNvbnN0cnVjdElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBvYnNlcnZhYmlsaXR5LiBXYXJuaW5nOiBhc3NvY2lhdGVkIGNvc3Qgd2l0aCB0aGUgc2VydmljZXNcbiAgICogdXNlZC4gQmVzdCBwcmFjdGljZSB0byBlbmFibGUgYnkgZGVmYXVsdC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSB0cnVlXG4gICAqL1xuICByZWFkb25seSBvYnNlcnZhYmlsaXR5PzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIEJhc2VDbGFzcyBleHRlbmRzIENvbnN0cnVjdCB7XG5cbiAgLyoqXG4gICAqIFJlY29yZDxzdHJpbmcsIG51bWJlcj4gLCBtYXBzIGNvbnN0cnVjdCBuYW1lIHdpdGggbnVtYmVyIG9mIGRlcGxveW1lbnRzXG4gICAqL1xuICBwcm90ZWN0ZWQgc3RhdGljIHVzYWdlTWV0cmljTWFwIDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHtcbiAgICBbQ29uc3RydWN0TmFtZS5BV1NNT0RFTERFUExPWU1FTlRTQUdFTUFLRVJdOiAwLFxuICAgIFtDb25zdHJ1Y3ROYW1lLkNVU1RPTVNBR0VNQUtFUkVORFBPSU5UXTogMCxcbiAgICBbQ29uc3RydWN0TmFtZS5IVUdHSU5HRkFDRVNBR0VNQUtFUkVORFBPSU5UXTogMCxcbiAgICBbQ29uc3RydWN0TmFtZS5KVU1QU1RBUlRTQUdFTUFLRVJFTkRQT0lOVF06IDAsXG4gIH07XG5cblxuICAvKipcbiAgICogY29uc3RydWN0IHVzYWdlIG1ldHJpYyAsIGFkZGVkIGluIHRlbXBsYXRlIGRlc2NyaXB0aW9uXG4gICAqL1xuICByZWFkb25seSBjb25zdHJ1Y3RVc2FnZU1ldHJpYyA9ICd1a3NiLTF0dXBib2M0NSc7XG5cbiAgLyoqXG4gICAqIFZhbHVlIHdpbGwgYmUgYXBwZW5kZWQgdG8gcmVzb3VyY2VzIG5hbWUuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gX2RldlxuICAgKi9cbiAgc3RhZ2UhOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIGVuYWJsZSBkaXNhYmxlIGxhbWJkYSB0cmFjaW5nXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gQWN0aXZlXG4gICAqL1xuICBsYW1iZGFUcmFjaW5nOiBsYW1iZGEuVHJhY2luZyA9IGxhbWJkYS5UcmFjaW5nLkFDVElWRTtcblxuICAvKipcbiAgICogZW5hYmxlIGRpc2FibGUgeHJheSB0cmFjaW5nXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gVHJ1ZVxuICAgKi9cbiAgZW5hYmxleHJheTogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgIGxvZyBjb25maWcgZm9yIGFsbCBjb25zdHJ1Y3RzXG4gICAqL1xuICBmaWVsZExvZ0xldmVsOmFwcHN5bmMuRmllbGRMb2dMZXZlbCA9IGFwcHN5bmMuRmllbGRMb2dMZXZlbC5BTEw7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgIGxvZyByZXRlbnRpb24gY29uZmlnIGZvciBhbGwgY29uc3RydWN0c1xuICAgKi9cbiAgcmV0ZW50aW9uOiBsb2dzLlJldGVudGlvbkRheXMgPSBsb2dzLlJldGVudGlvbkRheXMuVEVOX1lFQVJTO1xuXG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgfVxuXG4gIC8vb3ZlcndyaXRlIGRlZmF1bHQgZW52IHN1ZmZpeFxuICBwcm90ZWN0ZWQgdXBkYXRlRW52U3VmZml4KHByb3BzOiBCYXNlQ2xhc3NQcm9wcykge1xuICAgIGxldCBzdGFnZSA9ICctZGV2JztcbiAgICBpZiAocHJvcHM/LnN0YWdlKSB7XG4gICAgICBzdGFnZSA9IHByb3BzLnN0YWdlO1xuICAgIH1cbiAgICB0aGlzLnN0YWdlID0gc3RhZ2U7XG4gIH1cblxuICAvKlxuICAqIHVwZGF0ZSB0ZW1wbGF0ZSBkZXNjcmlwdGlvbiB3aXRoIGNvbnN0cnVjdCB1c2FnZSBtZXRyaWMgYW5kXG4gICogYWRkIEFXU19TREtfVUFfQVBQX0lEIHRvIHVzZXIgYWdlbnQgb24gYXdzIHNkay5cbiAgKi9cbiAgcHJvdGVjdGVkIHVwZGF0ZUNvbnN0cnVjdFVzYWdlTWV0cmljQ29kZShwcm9wczogQmFzZUNsYXNzUHJvcHMsIHNjb3BlOiBDb25zdHJ1Y3QsIGxhbWJkYUZ1bmN0aW9uczogbGFtYmRhLkRvY2tlckltYWdlRnVuY3Rpb25bXSxcbiAgKSB7XG4gICAgY29uc3Qgc29sdXRpb25JZCA9IGBnZW5haV9jZGtfJHt2ZXJzaW9ufS8ke3Byb3BzLmNvbnN0cnVjdE5hbWV9LyR7cHJvcHMuY29uc3RydWN0SWR9YDtcblxuICAgIGlmIChsYW1iZGFGdW5jdGlvbnNcbiAgICAgICAgJiYgbGFtYmRhRnVuY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAobGV0IGxhbWJkYUZ1bmN0aW9uIG9mIGxhbWJkYUZ1bmN0aW9ucykge1xuICAgICAgICBsYW1iZGFGdW5jdGlvbi5hZGRFbnZpcm9ubWVudChcbiAgICAgICAgICAnQVdTX1NES19VQV9BUFBfSUQnLCBzb2x1dGlvbklkLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwcm9wcyAmJiBCYXNlQ2xhc3MudXNhZ2VNZXRyaWNNYXAuaGFzT3duUHJvcGVydHkocHJvcHMuY29uc3RydWN0TmFtZSkpIHtcbiAgICAgIEJhc2VDbGFzcy51c2FnZU1ldHJpY01hcFtwcm9wcy5jb25zdHJ1Y3ROYW1lXSA9IEJhc2VDbGFzcy51c2FnZU1ldHJpY01hcFtwcm9wcy5jb25zdHJ1Y3ROYW1lXSArIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IEVycm9yKCdjb25zdHJ1Y3QgbmFtZSBpcyBub3QgcHJlc2VudCBpbiB1c2FnZU1ldHJpY01hcCAnKTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2FnZU1ldHJpY01hcFNlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeShCYXNlQ2xhc3MudXNhZ2VNZXRyaWNNYXApLnJlcGxhY2UoL1t7fV0vZywgJycpLnJlcGxhY2UoL1wiL2csICcnKTtcblxuICAgIC8vIERlc2NyaXB0aW9uIGZvcm1hdCA6KHVzYWdlIGlkIDp1a3NiLTF0dXBib2M0NSkodmVyc2lvbjowLjAuMCkgKGNvbnN0cnVjdHMgOjo6e1xcXCJDMVxcXCI6MSxcXFwiQzJcXFwiOjUsXFxcIkMzXFxcIjozLFxcXCJDNFxcXCI6MCxcXFwiQzVcXFwiOjAsXFxcIkM2XFxcIjowLFxcXCJDN1xcXCI6MCxcXFwiQzhcXFwiOjB9KSBcIixcbiAgICAvLyB3aGVyZSBDMSxDMiwgZXRjIGFyZSBtYXBwZWQgd2l0aCBjb25zdHJ1Y3QtbmFtZS1lbnVtIGFuZCB0aGUgdmFsdWVzIHNob3dzIHRoZSBudW1iZXIgb2YgdGltZSBzdGFjayBjcmVhdGVkL2RlbGV0ZWQuXG4gICAgU3RhY2sub2Yoc2NvcGUpLnRlbXBsYXRlT3B0aW9ucy5kZXNjcmlwdGlvbiA9XG4gICAgYERlc2NyaXB0aW9uOiAoJHt0aGlzLmNvbnN0cnVjdFVzYWdlTWV0cmljfSkgKHZlcnNpb246JHt2ZXJzaW9ufSkgKHRhZzokeyB1c2FnZU1ldHJpY01hcFNlcmlhbGl6ZWR9KSBgO1xuXG4gIH1cblxuICAvLyBvYnNlcnZhYmlsaXR5XG4gIHByb3RlY3RlZCBhZGRPYnNlcnZhYmlsaXR5VG9Db25zdHJ1Y3QocHJvcHM6IEJhc2VDbGFzc1Byb3BzKSB7XG4gICAgaWYgKHByb3BzLm9ic2VydmFiaWxpdHkgPT0gZmFsc2UpIHtcbiAgICAgIHRoaXMuZW5hYmxleHJheSA9IGZhbHNlO1xuICAgICAgdGhpcy5sYW1iZGFUcmFjaW5nID0gbGFtYmRhLlRyYWNpbmcuRElTQUJMRUQ7XG4gICAgICB0aGlzLmZpZWxkTG9nTGV2ZWwgPSBhcHBzeW5jLkZpZWxkTG9nTGV2ZWwuTk9ORTtcbiAgICAgIHRoaXMucmV0ZW50aW9uID0gbG9ncy5SZXRlbnRpb25EYXlzLlRFTl9ZRUFSUztcbiAgICB9O1xuICB9XG59XG4iXX0=