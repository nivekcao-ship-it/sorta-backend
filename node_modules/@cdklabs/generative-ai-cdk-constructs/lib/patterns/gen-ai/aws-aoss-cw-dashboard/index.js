"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AossCwDashboard = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_cloudwatch_1 = require("aws-cdk-lib/aws-cloudwatch");
const constructs_1 = require("constructs");
/**
 * The BedrockCwDashboard class.
 */
class AossCwDashboard extends constructs_1.Construct {
    /**
     * Constructs a new instance of the AossCwDashboard class.
     * @param {cdk.App} scope - represents the scope for all the resources.
     * @param {string} id - this is a a scope-unique id.
     * @param {AossCwDashboardProps} props - user provided props for the construct.
     * @since 0.0.0
     * @public
     */
    constructor(scope, id, props) {
        super(scope, id);
        this.dashboard = props.existingDashboard ?? new aws_cloudwatch_1.Dashboard(this, 'AossMetricsDashboard', {
            dashboardName: props.dashboardName ?? 'AossMetricsDashboard',
        });
    }
    /* Provide metrics for a specific aoss collection
     * @param {string} collectionName - Name of the aoss collection to monitor.
     * @param {string} collectionId - Id of the aoss collection to monitor.
     * @param {CollectionMonitoringProps} props - user provided props for monitoring.
    */
    addCollectionMonitoringbyAttributes(collectionName, collectionId, props) {
        const period = props.period ?? aws_cdk_lib_1.Duration.hours(1);
        const clientId = props.clientId ?? aws_cdk_lib_1.Aws.ACCOUNT_ID;
        const dimensionMap = {
            ClientId: clientId,
            CollectionId: collectionId,
            CollectionName: collectionName,
        };
        this.dashboard.addWidgets(new aws_cloudwatch_1.TextWidget({
            markdown: '# OpenSearch Vector Database (collection level)',
            width: 24,
        }));
        // Response codes
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'OpenSearch response codes',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [
                new aws_cloudwatch_1.Metric({
                    metricName: '2xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '3xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '4xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '5xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
            ],
        }));
        // Search
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Search Request Latency',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchRequestLatency',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Search Request Errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchRequestErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        // Ingestion
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Successes',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestSuccess',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Latency',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestLatency',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
    }
    /* Provide metrics for a specific aoss collection
     * @param {string} collection - CfnCollection to monitor.
     * @param {CollectionMonitoringProps} props - user provided props for monitoring.
    */
    addCollectionMonitoringByCollection(collection, props) {
        this.addCollectionMonitoringbyAttributes(collection.name, collection.attrId, props);
    }
    /* Provide metrics for a specific aoss index
     * @param {string} collectionName - Name of the aoss collection to monitor.
     * @param {string} collectionId - Id of the aoss collection to monitor.
     * @param {string} IndexName - Name of the aoss index to monitor.
     * @param {string} IndexId - Id of the aoss index to monitor.
     * @param {IndexMonitoringProps} props - user provided props for monitoring.
    */
    addIndexMonitoringByAtributes(collectionName, collectionId, IndexName, IndexId, props) {
        const period = props.period ?? aws_cdk_lib_1.Duration.hours(1);
        const clientId = props.clientId ?? aws_cdk_lib_1.Aws.ACCOUNT_ID;
        const dimensionMap = {
            ClientId: clientId,
            CollectionId: collectionId,
            CollectionName: collectionName,
            IndexId: IndexId,
            IndexName: IndexName,
        };
        this.dashboard.addWidgets(new aws_cloudwatch_1.TextWidget({
            markdown: '# OpenSearch Vector Database (index level)',
            width: 24,
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Deleted documents',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'DeletedDocuments',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Searchable documents',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchableDocuments',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'S3 storage consumption',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'StorageUsedInS3',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Document ingestion rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDocumentRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDocumentErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Document data rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDataRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
    }
}
exports.AossCwDashboard = AossCwDashboard;
_a = JSII_RTTI_SYMBOL_1;
AossCwDashboard[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.AossCwDashboard", version: "0.1.309" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGF0dGVybnMvZ2VuLWFpL2F3cy1hb3NzLWN3LWRhc2hib2FyZC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Ozs7OztHQVdHO0FBRUgsNkNBQTRDO0FBQzVDLCtEQU9vQztBQUVwQywyQ0FBdUM7QUEyRHZDOztHQUVHO0FBQ0gsTUFBYSxlQUFnQixTQUFRLHNCQUFTO0lBTzVDOzs7Ozs7O09BT0c7SUFDSCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQTJCO1FBQ25FLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFakIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsaUJBQWlCLElBQUksSUFBSSwwQkFBUyxDQUFDLElBQUksRUFBRSxzQkFBc0IsRUFBRTtZQUN0RixhQUFhLEVBQUUsS0FBSyxDQUFDLGFBQWEsSUFBSSxzQkFBc0I7U0FDN0QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7O01BSUU7SUFDSyxtQ0FBbUMsQ0FBQyxjQUFzQixFQUFFLFlBQW9CLEVBQUUsS0FBZ0M7UUFFdkgsTUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sSUFBSSxzQkFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqRCxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxJQUFJLGlCQUFHLENBQUMsVUFBVSxDQUFDO1FBRWxELE1BQU0sWUFBWSxHQUFHO1lBQ25CLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLFlBQVksRUFBRSxZQUFZO1lBQzFCLGNBQWMsRUFBRSxjQUFjO1NBQy9CLENBQUM7UUFFRixJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxJQUFJLDJCQUFVLENBQUM7WUFDdkMsUUFBUSxFQUFFLGlEQUFpRDtZQUMzRCxLQUFLLEVBQUUsRUFBRTtTQUNWLENBQUMsQ0FB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LDRCQUFXLENBQUM7WUFDZCxLQUFLLEVBQUUsa0JBQWtCO1lBQ3pCLElBQUksRUFBRSxnQ0FBZSxDQUFDLFdBQVc7WUFDakMsS0FBSyxFQUFFLEVBQUU7WUFDVCxJQUFJLEVBQUUsQ0FBQyxJQUFJLHVCQUFNLENBQUM7b0JBQ2hCLFVBQVUsRUFBRSx5QkFBeUI7b0JBQ3JDLFNBQVMsRUFBRSxVQUFVO29CQUNyQixTQUFTLEVBQUUsc0JBQUssQ0FBQyxHQUFHO29CQUNwQixhQUFhLEVBQUUsWUFBWTtvQkFDM0IsTUFBTSxFQUFFLE1BQU07aUJBQ2YsQ0FBQyxDQUFDO1NBQ0osQ0FBQyxFQUNGLElBQUksNEJBQVcsQ0FBQztZQUNkLEtBQUssRUFBRSxvQkFBb0I7WUFDM0IsSUFBSSxFQUFFLGdDQUFlLENBQUMsV0FBVztZQUNqQyxLQUFLLEVBQUUsRUFBRTtZQUNULElBQUksRUFBRSxDQUFDLElBQUksdUJBQU0sQ0FBQztvQkFDaEIsVUFBVSxFQUFFLG1CQUFtQjtvQkFDL0IsU0FBUyxFQUFFLFVBQVU7b0JBQ3JCLFNBQVMsRUFBRSxzQkFBSyxDQUFDLEdBQUc7b0JBQ3BCLGFBQWEsRUFBRSxZQUFZO29CQUMzQixNQUFNLEVBQUUsTUFBTTtpQkFDZixDQUFDLENBQUM7U0FDSixDQUFDLENBQ0gsQ0FBQztJQUVKLENBQUM7O0FBL1JILDBDQWdTQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogIENvcHlyaWdodCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiAgd2l0aCB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqICBvciBpbiB0aGUgJ2xpY2Vuc2UnIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICdBUyBJUycgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFU1xuICogIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiAgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IER1cmF0aW9uLCBBd3MgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQge1xuICBNZXRyaWMsXG4gIERhc2hib2FyZCxcbiAgR3JhcGhXaWRnZXQsXG4gIEdyYXBoV2lkZ2V0VmlldyxcbiAgU3RhdHMsXG4gIFRleHRXaWRnZXQsXG59IGZyb20gJ2F3cy1jZGstbGliL2F3cy1jbG91ZHdhdGNoJztcbmltcG9ydCB7IENmbkNvbGxlY3Rpb24gfSBmcm9tICdhd3MtY2RrLWxpYi9hd3Mtb3BlbnNlYXJjaHNlcnZlcmxlc3MnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5cblxuLyoqXG4gKiBUaGUgcHJvcGVydGllcyBmb3IgdGhlIENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMgY2xhc3MuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29sbGVjdGlvbk1vbml0b3JpbmdQcm9wcyB7XG4gIC8qXG4gICAgKiBPcHRpb25hbCAtIFRoZSBwZXJpb2Qgb3ZlciB3aGljaCB0aGUgc3BlY2lmaWVkIHN0YXRpc3RpYyBpcyBhcHBsaWVkLlxuICAgICogQGRlZmF1bHQgLSAxIGhvdXJcbiAgICAqL1xuICByZWFkb25seSBwZXJpb2Q/OiBEdXJhdGlvbjtcblxuICAvKlxuICAgICogT3B0aW9uYWwgLSBUaGUgY2xpZW50IElEIHRvIHVzZS5cbiAgICAqIEBkZWZhdWx0IC0gQWNjb3VudCBJRFxuICAgICovXG4gIHJlYWRvbmx5IGNsaWVudElkPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIFRoZSBwcm9wZXJ0aWVzIGZvciB0aGUgQ29sbGVjdGlvbk1vbml0b3JpbmdQcm9wcyBjbGFzcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJbmRleE1vbml0b3JpbmdQcm9wcyB7XG4gIC8qXG4gICAgKiBPcHRpb25hbCAtIFRoZSBwZXJpb2Qgb3ZlciB3aGljaCB0aGUgc3BlY2lmaWVkIHN0YXRpc3RpYyBpcyBhcHBsaWVkLlxuICAgICogQGRlZmF1bHQgLSAxIGhvdXJcbiAgICAqL1xuICByZWFkb25seSBwZXJpb2Q/OiBEdXJhdGlvbjtcbiAgLypcbiAgICAqIE9wdGlvbmFsIC0gVGhlIGNsaWVudCBJRCB0byB1c2UuXG4gICAgKiBAZGVmYXVsdCAtIEFjY291bnQgSURcbiAgICAqL1xuICByZWFkb25seSBjbGllbnRJZD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgcHJvcGVydGllcyBmb3IgdGhlIEJlZHJvY2tDd0Rhc2hib2FyZFByb3BzIGNsYXNzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEFvc3NDd0Rhc2hib2FyZFByb3BzIHtcblxuICAvKipcbiAgICogT3B0aW9uYWwgQW4gZXhpc3RpbmcgZGFzaGJvYXJkIHdoZXJlIG1ldHJpY3Mgd2lsbCBiZSBhZGRlZCB0by5cbiAgICogSWYgbm90IHByb3ZpZGVkLCB0aGUgY29uc3RydWN0IHdpbGwgY3JlYXRlIGEgbmV3IGRhc2hib2FyZFxuICAgKlxuICAgKiBAZGVmYXVsdCAtIG5vbmVcbiAgICovXG4gIHJlYWRvbmx5IGV4aXN0aW5nRGFzaGJvYXJkPzogRGFzaGJvYXJkO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBBIG5hbWUgZm9yIHRoZSBkYXNoYm9hcmQgd2hpY2ggd2lsbCBiZSBjcmVhdGVkLlxuICAgKiBJZiBleGlzdGluZ0Rhc2hib2FyZCBpcyBkZWZpbmVkLCB0aGlzIHZhbHVlIHdpbGwgYmUgaWdub3JlZC5cbiAgICogSWYgbm90IHByb3ZpZGVkLCB0aGUgY29uc3RydWN0IHdpbGwgY3JlYXRlIGEgbmV3IGRhc2hib2FyZCBuYW1lZCAnQmVkcm9ja01ldHJpY3NEYXNoYm9hcmQnXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm9uZVxuICAgKi9cbiAgcmVhZG9ubHkgZGFzaGJvYXJkTmFtZT86IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgQmVkcm9ja0N3RGFzaGJvYXJkIGNsYXNzLlxuICovXG5leHBvcnQgY2xhc3MgQW9zc0N3RGFzaGJvYXJkIGV4dGVuZHMgQ29uc3RydWN0IHtcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgaW5zdGFuY2Ugb2YgQ2xvdWRXYXRjaCBkYXNoYm9hcmQgdXNlZCBieSB0aGUgY29uc3RydWN0XG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZGFzaGJvYXJkOiBEYXNoYm9hcmQ7XG5cbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIEFvc3NDd0Rhc2hib2FyZCBjbGFzcy5cbiAgICogQHBhcmFtIHtjZGsuQXBwfSBzY29wZSAtIHJlcHJlc2VudHMgdGhlIHNjb3BlIGZvciBhbGwgdGhlIHJlc291cmNlcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gdGhpcyBpcyBhIGEgc2NvcGUtdW5pcXVlIGlkLlxuICAgKiBAcGFyYW0ge0Fvc3NDd0Rhc2hib2FyZFByb3BzfSBwcm9wcyAtIHVzZXIgcHJvdmlkZWQgcHJvcHMgZm9yIHRoZSBjb25zdHJ1Y3QuXG4gICAqIEBzaW5jZSAwLjAuMFxuICAgKiBAcHVibGljXG4gICAqL1xuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogQW9zc0N3RGFzaGJvYXJkUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgdGhpcy5kYXNoYm9hcmQgPSBwcm9wcy5leGlzdGluZ0Rhc2hib2FyZCA/PyBuZXcgRGFzaGJvYXJkKHRoaXMsICdBb3NzTWV0cmljc0Rhc2hib2FyZCcsIHtcbiAgICAgIGRhc2hib2FyZE5hbWU6IHByb3BzLmRhc2hib2FyZE5hbWUgPz8gJ0Fvc3NNZXRyaWNzRGFzaGJvYXJkJyxcbiAgICB9KTtcbiAgfVxuXG4gIC8qIFByb3ZpZGUgbWV0cmljcyBmb3IgYSBzcGVjaWZpYyBhb3NzIGNvbGxlY3Rpb25cbiAgICogQHBhcmFtIHtzdHJpbmd9IGNvbGxlY3Rpb25OYW1lIC0gTmFtZSBvZiB0aGUgYW9zcyBjb2xsZWN0aW9uIHRvIG1vbml0b3IuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjb2xsZWN0aW9uSWQgLSBJZCBvZiB0aGUgYW9zcyBjb2xsZWN0aW9uIHRvIG1vbml0b3IuXG4gICAqIEBwYXJhbSB7Q29sbGVjdGlvbk1vbml0b3JpbmdQcm9wc30gcHJvcHMgLSB1c2VyIHByb3ZpZGVkIHByb3BzIGZvciBtb25pdG9yaW5nLlxuICAqL1xuICBwdWJsaWMgYWRkQ29sbGVjdGlvbk1vbml0b3JpbmdieUF0dHJpYnV0ZXMoY29sbGVjdGlvbk5hbWU6IHN0cmluZywgY29sbGVjdGlvbklkOiBzdHJpbmcsIHByb3BzOiBDb2xsZWN0aW9uTW9uaXRvcmluZ1Byb3BzKSB7XG5cbiAgICBjb25zdCBwZXJpb2QgPSBwcm9wcy5wZXJpb2QgPz8gRHVyYXRpb24uaG91cnMoMSk7XG4gICAgY29uc3QgY2xpZW50SWQgPSBwcm9wcy5jbGllbnRJZCA/PyBBd3MuQUNDT1VOVF9JRDtcblxuICAgIGNvbnN0IGRpbWVuc2lvbk1hcCA9IHtcbiAgICAgIENsaWVudElkOiBjbGllbnRJZCxcbiAgICAgIENvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkLFxuICAgICAgQ29sbGVjdGlvbk5hbWU6IGNvbGxlY3Rpb25OYW1lLFxuICAgIH07XG5cbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKG5ldyBUZXh0V2lkZ2V0KHtcbiAgICAgIG1hcmtkb3duOiAnIyBPcGVuU2VhcmNoIFZlY3RvciBEYXRhYmFzZSAoY29sbGVjdGlvbiBsZXZlbCknLFxuICAgICAgd2lkdGg6IDI0LFxuICAgIH0pKTtcblxuICAgIC8vIFJlc3BvbnNlIGNvZGVzXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnT3BlblNlYXJjaCByZXNwb25zZSBjb2RlcycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnMnh4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnM3h4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnNHh4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnNXh4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgIF0sXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgLy8gU2VhcmNoXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnU2VhcmNoIFJlcXVlc3QgTGF0ZW5jeScsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ1NlYXJjaFJlcXVlc3RMYXRlbmN5JyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5BVkVSQUdFLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ1NlYXJjaCBSZXF1ZXN0IEVycm9ycycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ1NlYXJjaFJlcXVlc3RFcnJvcnMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICAvLyBJbmdlc3Rpb25cbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdJbmdlc3Rpb24gUmVxdWVzdCBTdWNjZXNzZXMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25SZXF1ZXN0U3VjY2VzcycsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0luZ2VzdGlvbiBSZXF1ZXN0IFJhdGUnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25SZXF1ZXN0UmF0ZScsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuQVZFUkFHRSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnSW5nZXN0aW9uIFJlcXVlc3QgTGF0ZW5jeScsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvblJlcXVlc3RMYXRlbmN5JyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5BVkVSQUdFLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0luZ2VzdGlvbiBSZXF1ZXN0IEVycm9ycycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvblJlcXVlc3RFcnJvcnMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG5cblxuICB9XG5cbiAgLyogUHJvdmlkZSBtZXRyaWNzIGZvciBhIHNwZWNpZmljIGFvc3MgY29sbGVjdGlvblxuICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbiAtIENmbkNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtDb2xsZWN0aW9uTW9uaXRvcmluZ1Byb3BzfSBwcm9wcyAtIHVzZXIgcHJvdmlkZWQgcHJvcHMgZm9yIG1vbml0b3JpbmcuXG4gICovXG4gIHB1YmxpYyBhZGRDb2xsZWN0aW9uTW9uaXRvcmluZ0J5Q29sbGVjdGlvbihjb2xsZWN0aW9uOiBDZm5Db2xsZWN0aW9uLCBwcm9wczogQ29sbGVjdGlvbk1vbml0b3JpbmdQcm9wcykge1xuXG4gICAgdGhpcy5hZGRDb2xsZWN0aW9uTW9uaXRvcmluZ2J5QXR0cmlidXRlcyhjb2xsZWN0aW9uLm5hbWUsIGNvbGxlY3Rpb24uYXR0cklkLCBwcm9wcyk7XG5cbiAgfVxuXG4gIC8qIFByb3ZpZGUgbWV0cmljcyBmb3IgYSBzcGVjaWZpYyBhb3NzIGluZGV4XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjb2xsZWN0aW9uTmFtZSAtIE5hbWUgb2YgdGhlIGFvc3MgY29sbGVjdGlvbiB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbklkIC0gSWQgb2YgdGhlIGFvc3MgY29sbGVjdGlvbiB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gSW5kZXhOYW1lIC0gTmFtZSBvZiB0aGUgYW9zcyBpbmRleCB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gSW5kZXhJZCAtIElkIG9mIHRoZSBhb3NzIGluZGV4IHRvIG1vbml0b3IuXG4gICAqIEBwYXJhbSB7SW5kZXhNb25pdG9yaW5nUHJvcHN9IHByb3BzIC0gdXNlciBwcm92aWRlZCBwcm9wcyBmb3IgbW9uaXRvcmluZy5cbiAgKi9cbiAgcHVibGljIGFkZEluZGV4TW9uaXRvcmluZ0J5QXRyaWJ1dGVzKFxuICAgIGNvbGxlY3Rpb25OYW1lOiBzdHJpbmcsXG4gICAgY29sbGVjdGlvbklkOiBzdHJpbmcsXG4gICAgSW5kZXhOYW1lOiBzdHJpbmcsXG4gICAgSW5kZXhJZDogc3RyaW5nLFxuICAgIHByb3BzOiBJbmRleE1vbml0b3JpbmdQcm9wcyxcbiAgKSB7XG5cbiAgICBjb25zdCBwZXJpb2QgPSBwcm9wcy5wZXJpb2QgPz8gRHVyYXRpb24uaG91cnMoMSk7XG4gICAgY29uc3QgY2xpZW50SWQgPSBwcm9wcy5jbGllbnRJZCA/PyBBd3MuQUNDT1VOVF9JRDtcblxuICAgIGNvbnN0IGRpbWVuc2lvbk1hcCA9IHtcbiAgICAgIENsaWVudElkOiBjbGllbnRJZCxcbiAgICAgIENvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkLFxuICAgICAgQ29sbGVjdGlvbk5hbWU6IGNvbGxlY3Rpb25OYW1lLFxuICAgICAgSW5kZXhJZDogSW5kZXhJZCxcbiAgICAgIEluZGV4TmFtZTogSW5kZXhOYW1lLFxuICAgIH07XG5cbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKG5ldyBUZXh0V2lkZ2V0KHtcbiAgICAgIG1hcmtkb3duOiAnIyBPcGVuU2VhcmNoIFZlY3RvciBEYXRhYmFzZSAoaW5kZXggbGV2ZWwpJyxcbiAgICAgIHdpZHRoOiAyNCxcbiAgICB9KSk7XG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnRGVsZXRlZCBkb2N1bWVudHMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdEZWxldGVkRG9jdW1lbnRzJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnU2VhcmNoYWJsZSBkb2N1bWVudHMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdTZWFyY2hhYmxlRG9jdW1lbnRzJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICApO1xuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMoXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ1MzIHN0b3JhZ2UgY29uc3VtcHRpb24nLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdTdG9yYWdlVXNlZEluUzMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdEb2N1bWVudCBpbmdlc3Rpb24gcmF0ZScsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvbkRvY3VtZW50UmF0ZScsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgKTtcbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdJbmdlc3Rpb24gZXJyb3JzJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnSW5nZXN0aW9uRG9jdW1lbnRFcnJvcnMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdEb2N1bWVudCBkYXRhIHJhdGUnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25EYXRhUmF0ZScsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgKTtcblxuICB9XG59XG5cbiJdfQ==